<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>Getting started</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<P><HR>
<A NAME="0005">
<A HREF="xc000.html#root" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="xc001.html#0004" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0006" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H1>Getting started</H1>

<P>In this and following chapters we assume that XDS is properly installed and configured (See Chapter <A HREF="xc003.html#0013" TARGET=body>Configuring the compiler</A>); the default file extensions are used. 
<P>Your XDS package contains a script file, xc<TT>work</TT>, which may be used to prepare a working directory. For more information, consult your <TT>readme.1st</TT> file from the XDS on-line documentation. 
<P><UL>
<LI><A HREF="#0006" TARGET=body>Using the Modula-2 compiler</A>
<LI><A HREF="#0007" TARGET=body>Using the Oberon-2 compiler</A>
<LI><A HREF="#0008" TARGET=body>Error reporting</A>
<LI><A HREF="#0010" TARGET=body>Building a program</A>
<LI><A HREF="#0011" TARGET=body>Debugging a program</A>
</UL>
<P><HR>
<A NAME="0006">
<A HREF="#0005" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0005" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0007" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Using the Modula-2 compiler</H2>

<P>In the working directory, use a text editor to create a file called <B>hello.mod</B>, containing the following text: 
<P><PRE>&nbsp;&nbsp;&nbsp;&nbsp;MODULE&nbsp;hello;

&nbsp;&nbsp;&nbsp;&nbsp;IMPORT&nbsp;InOut;

&nbsp;&nbsp;&nbsp;&nbsp;BEGIN
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InOut.WriteString(&quot;Hello&nbsp;World&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InOut.WriteLn;
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;hello.
</PRE>

<P>Type 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xc</TT><TT>&nbsp;hello.mod</TT> 
<P>at the command prompt. <TT>xc</TT> will know that the Modula-2 compiler should be invoked for the source file with the extension <B>.mod</B>. The compiler heading line will appear: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;XDS&nbsp;Modula-2&nbsp;</TT><I>version</I><TT>&nbsp;[</TT><I>code generator</I><TT>]&nbsp;&quot;hello.mod&quot;</TT> 
<P>showing which compiler has been invoked (including its version number), which code generator is being used (in square brackets) and what is its version, and finally the name of the source file <TT>xc</TT> has been asked to compile. 
<P>Assuming that you have correctly typed the source file, the compiler will then display something like 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;errors,&nbsp;no&nbsp;warnings,&nbsp;lines&nbsp;&nbsp;&nbsp;15,&nbsp;time&nbsp;&nbsp;1.09</TT> 
<P>showing the number of errors, the number of source lines and the compilation time. 
<P><B>Note:</B> The XDS compiler reports are user configurable. If the lines similar to the above do not appear, check that the <A HREF="xc005.html#0135" TARGET=body>DECOR</A> equation value contains letters &lsquo;C&rsquo; (compiler heading) and &lsquo;R&rsquo; (report). 
<P><HR>
<A NAME="0007">
<A HREF="#0005" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0006" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0008" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Using the Oberon-2 compiler</H2>

<P>In our bilingual system the Modula-2 source code just shown is also perfectly valid as the Oberon-2 code. XDS allows you to use Modula-2 libraries when programming in Oberon-2 (in our case the <TT>InOut</TT> module). 
<P>As in Modula-2, this source code in Oberon-2 constitutes a <I>top-level module</I> or <I>program module</I>, but in Oberon-2, there is no syntactic distinction between a top-level module and any other module. The Oberon-2 compiler must be specifically told that this is a top-level module by using the option <A HREF="xc005.html#0095" TARGET=body>MAIN</A>. 
<P>Copy the source file to the file <B>hello.ob2</B> and type: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT>xc<TT>&nbsp;hello.ob2&nbsp;+MAIN</TT> 
<P>The same sequence of reports will occur as that of the Modula-2 compiler, but the Oberon-2 compiler will also report whether a new symbol file was generated or not. It is also possible to override the default source file extension using <A HREF="xc005.html#0090" TARGET=body>M2</A> and <A HREF="xc005.html#0101" TARGET=body>O2</A> options: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT>xc<TT>&nbsp;hello.mod&nbsp;+O2&nbsp;+MAIN</TT> 
<P>In this case, the Oberon-2 compiler will be invoked regardless of the file extension. 
<P><HR>
<A NAME="0008">
<A HREF="#0005" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0007" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0009" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Error reporting</H2>

<P>If either compiler detects an error in your code, an error description will be displayed. In most cases a copy of the source line will also be shown with a dollar sign <TT>&quot;$&quot;</TT> placed directly before the point at which the error occurred. The format in which XDS reports errors is user configurable (See <A HREF="xc005.html#0163" TARGET=body>Error message format specification</A>), by default it includes a file name, a position (line and column numbers) at which the error occurred, an error type indicator, which can be [E]rror, [W]arning or [F]ault, an error number, and an error message. 
<P><A NAME="0009">
<A HREF="xc001.html#0004" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0008" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0010" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H5>Example</H5>

<P><PRE>*&nbsp;[bf.mod&nbsp;26.03&nbsp;W310]
*&nbsp;infinite&nbsp;loop
&nbsp;&nbsp;$LOOP
</PRE>

<P>
<P><HR>
<A NAME="0010">
<A HREF="#0005" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0009" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0011" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Building a program</H2>

<P>To have you program automatically linked, invoke the compiler in the <A HREF="xc004.html#0036" TARGET=body>MAKE mode</A>: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xc</TT><TT>&nbsp;=m&nbsp;hello.mod</TT> 
<P>In this mode, the compiler processes all modules which are imported by the module specified on the command line, compiling them if necessary. Then, if the specified module was a program module, the linker is invoked. 
<P>However, if your program consists of several modules, we recommend to write a <A HREF="xc004.html#0049" TARGET=body>project file</A>. In the simplest case, it consists of a single line specifying a name of a main module: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;!module&nbsp;hello.mod</TT> 
<P>but it may also contain various <A HREF="xc005.html#0057" TARGET=body>option settings</A>. The following invocation 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xc</TT><TT>&nbsp;=p&nbsp;hello.prj</TT> 
<P>will compile modules constituting the project (if required) and then execute the linker. 
<P>Here is a more complex project file: 
<P><PRE>%&nbsp;debug&nbsp;ON
-gendebug+
-genhistory+
-lineno+
%&nbsp;optimize&nbsp;for&nbsp;Pentium
-cpu&nbsp;=&nbsp;pentium
%&nbsp;response&nbsp;file&nbsp;name
-mkfname&nbsp;=&nbsp;wlink
-mkfext&nbsp;&nbsp;=&nbsp;lnk
%&nbsp;specify&nbsp;an&nbsp;alternate&nbsp;template&nbsp;file
-template&nbsp;=&nbsp;wlink.tem
%&nbsp;linker&nbsp;command&nbsp;line
-link&nbsp;=&nbsp;&quot;wlink&nbsp;@%s&quot;,mkfname#mkfext;
%&nbsp;main&nbsp;module&nbsp;of&nbsp;the&nbsp;program
!module&nbsp;main.mod
%&nbsp;additional&nbsp;library
!module&nbsp;clib3s.lib
</PRE>

<P>After successful compilation of the whole project the compiler creates a linker response file using the specified <A HREF="xc004.html#0052" TARGET=body>template file</A> and then executes a command line specified by the <A HREF="xc005.html#0145" TARGET=body>LINK</A> equation. 
<P><HR>
<A NAME="0011">
<A HREF="#0005" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0010" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0012" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Debugging a program</H2>

<P>XDS compilers generate debug information in the stabs format and allow you to use any debugger compatible with that format (for example, GDB). However, the <I>postmorten history</I>feature of XDS run-time support may be used in many cases instead of debugger. To enable this feature, the option <A HREF="xc005.html#0088" TARGET=body>LINENO</A> should be set on for all modules in the program and the option <A HREF="xc005.html#0085" TARGET=body>GENHISTORY</A> for the main module of the program; the program also has to be linked with debug info included. If your program was built with the above settings, the run-time system dumps the stack of procedure calls on an abnormal termination into a file called <TT>errinfo.$$$</TT>. The HIS utility reads that file and outputs the call stack in terms of procedure names and line numbers using the debug info from your program&rsquo;s executable file. 
<P><A NAME="0012">
<A HREF="xc001.html#0004" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0011" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="xc003.html#0013" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H5>Example</H5>

<P><PRE>MODULE&nbsp;test;

PROCEDURE&nbsp;Div(a,b:&nbsp;INTEGER):&nbsp;INTEGER;
BEGIN
&nbsp;&nbsp;RETURN&nbsp;a&nbsp;DIV&nbsp;b
END&nbsp;Div;

PROCEDURE&nbsp;Try;
&nbsp;&nbsp;VAR&nbsp;res:&nbsp;INTEGER;
BEGIN
&nbsp;&nbsp;res:=Div(1,0);
END&nbsp;Try;

BEGIN
&nbsp;&nbsp;Try;
END&nbsp;test.
</PRE>

<P>When this program is running, an exception is raised and the run-time system stores the exception location and a stack of procedure calls in a file <TT>errinfo.$$$</TT> and displays the following message: 
<P><PRE>#RTS:&nbsp;unhandled&nbsp;exception&nbsp;#6:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;divisor

File&nbsp;errinfo.$$$&nbsp;created.
</PRE>

<P>
<P>The <TT>errinfo.$$$</TT> is not human readable. The HIS utility, once invoked, reads it along with the debug information from your program executable and outputs the call stack in a more usable form: 
<P>
<P><PRE>#RTS:&nbsp;unhandled&nbsp;exception&nbsp;#6:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;divisor
------------------------------------------------------------
Source&nbsp;file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LINE&nbsp;&nbsp;OFFSET&nbsp;&nbsp;PROCEDURE
------------------------------------------------------------
test.mod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;00000F&nbsp;&nbsp;Div
test.mod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;000037&nbsp;&nbsp;Try
test.mod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;000061&nbsp;&nbsp;main
</PRE>

<P>
<P>The exception was raised in line 5 of <TT>test.mod</TT>, the <TT>Div</TT> procedure was called from line 11, while the <TT>Try</TT> procedure was called from line 15 (module body). 
<P><B>Note:</B> In some cases, the history may be inaccurate. See <A HREF="xc009.html#0474" TARGET=body>Postmortem history</A> for further details. 
<P>
</BODY>
</HTML>
