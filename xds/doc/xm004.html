<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>Using the compiler</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<P><HR>
<A NAME="0033">
<A HREF="xm000.html#root" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="xm003.html#0032" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0034" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H1>Using the compiler</H1>

<P><UL>
<LI><A HREF="#0034" TARGET=body>Invoking the compiler</A>
<LI><A HREF="#0036" TARGET=body>XDS compilers operation modes</A>
<LI><A HREF="#0046" TARGET=body>Files generated during compilation</A>
<LI><A HREF="#0050" TARGET=body>Control file preprocessing</A>
<LI><A HREF="#0051" TARGET=body>Project files</A>
<LI><A HREF="#0052" TARGET=body>Make strategy</A>
<LI><A HREF="#0053" TARGET=body>Smart recompilation</A>
<LI><A HREF="#0054" TARGET=body>Template files</A>
</UL>
<P><HR>
<A NAME="0034">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0033" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0035" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Invoking the compiler</H2>

<P>The XDS Modula-2 and Oberon-2 compilers are combined together with the make subsystem and an Oberon-2 browser into a single utility, <TT>xm</TT>. When invoked without parameters, the utility outputs a brief help information. 
<P><TT>xm</TT> is invoked from the command line of the following form 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;{&nbsp;mode&nbsp;|&nbsp;option&nbsp;|&nbsp;name&nbsp;}</TT> 
<P>where <TT>name</TT>, depending on the operation <TT>mode</TT> can be a module name, a source file name, or a project file name. See <A HREF="#0036" TARGET=body>XDS compilers operation modes</A> for a full description of operation modes. 
<P><TT>option</TT> is a compiler setup directive (See <A HREF="xm003.html#0024" TARGET=body>Options</A>). All options are applied to all operands, notwithstanding their relative order on the command line. On some platforms, it may be necessary to enclose setup directives in quotation marks: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;hello.mod&nbsp;'-checkindex+'</TT> 
<P>See Chapter <A HREF="xm005.html#0059" TARGET=body>Compiler options and equations</A> for the list of all compiler options and equations. 
<P><UL>
<LI><A HREF="#0035" TARGET=body>Precedence of compiler options</A>
</UL>
<P><HR>
<A NAME="0035">
<A HREF="#0034" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0034" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0036" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>Precedence of compiler options</H3>

<P>The <TT>xm</TT> utility receives its options in the following order: 
<OL>
 
<LI>from a configuration file <B>xm.cfg</B> (See <A HREF="xm003.html#0026" TARGET=body>Configuration file</A>) </LI>
<LI>from the command line (See <A HREF="#0036" TARGET=body>XDS compilers operation modes</A>) </LI>
<LI>from a project file (if present) (See <A HREF="#0051" TARGET=body>Project files</A>) </LI>
<LI>from a source text (not all options can be used there) (See <A HREF="xm007.html#0456" TARGET=body>Source code directives</A>) </LI>
</OL>

<P>At any point during operation, the last value of an option is in effect. Thus, if the equation <A HREF="xm005.html#0157" TARGET=body>OBERON</A> was set to <B>.ob2</B> in a configuration file, but then set to <B>.o2</B> on the command line, the compiler will use <B>.o2</B> as the default Oberon-2 extension. 
<P><HR>
<A NAME="0036">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0035" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0037" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>XDS compilers operation modes</H2>

<P>XDS Modula-2/Oberon-2 compilers have the following operation modes: 
<TABLE CELLSPACING=0>
<TR>
<TD  STYLE="padding:0px 3px;border-style: none none solid none;border-width: 0px 0px 1px 0px"><B>Mode </B></TD>
<TD  STYLE="padding:0px 3px;border-style: none none solid none;border-width: 0px 0px 1px 0px"><B>Meaning </B></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><A HREF="#0037" TARGET=body>COMPILE</A> </TD>
<TD  STYLE="padding:0px 3px;">Compile all modules given on the command line </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><A HREF="#0039" TARGET=body>PROJECT</A> </TD>
<TD  STYLE="padding:0px 3px;">Make all projects given on the command line </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><A HREF="#0038" TARGET=body>MAKE</A> </TD>
<TD  STYLE="padding:0px 3px;">Check dependencies and recompile </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><A HREF="#0040" TARGET=body>GEN</A> </TD>
<TD  STYLE="padding:0px 3px;">Generate makefile for all projects </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><A HREF="#0041" TARGET=body>BROWSE</A> </TD>
<TD  STYLE="padding:0px 3px;">Extract definitions from symbol files </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;">HELP </TD>
<TD  STYLE="padding:0px 3px;">Print help and terminate </TD>
</TR>
</TABLE>
<P>Both the PROJECT and MAKE modes have two optional operation submodes: <A HREF="#0043" TARGET=body>BATCH</A> and <A HREF="#0042" TARGET=body>ALL</A>. Two auxiliary operation submodes &mdash; <A HREF="#0044" TARGET=body>options</A> and <A HREF="#0045" TARGET=body>EQUATIONS</A> can be used to inspect the set of compiler options and equations and their values. 
<P>On the command line, the compiler mode is specified with the &quot;<TT>=</TT>&quot; symbol followed by a mode name. Mode names are not case sensitive, and specifying an unique portion of a mode name is sufficient, thus 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;=PROJECT</TT> is equivalent to <TT>=p</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;=BROWSE&nbsp;</TT> is equivalent to <TT>=Bro</TT> 
<P>Operation modes and options can be placed on the command line in arbitrary order, so the following two command lines are equivalent: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=make&nbsp;hello.mod&nbsp;=all&nbsp;-checknil+</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;-checknil+&nbsp;=a&nbsp;=make&nbsp;hello.mod</TT> 
<P><UL>
<LI><A HREF="#0037" TARGET=body>COMPILE mode</A>
<LI><A HREF="#0038" TARGET=body>MAKE mode</A>
<LI><A HREF="#0039" TARGET=body>PROJECT mode</A>
<LI><A HREF="#0040" TARGET=body>GEN mode</A>
<LI><A HREF="#0041" TARGET=body>BROWSE mode</A>
<LI><A HREF="#0042" TARGET=body>ALL submode</A>
<LI><A HREF="#0043" TARGET=body>BATCH submode</A>
<LI><A HREF="#0044" TARGET=body>OPTIONS submode</A>
<LI><A HREF="#0045" TARGET=body>EQUATIONS submode</A>
</UL>
<P><HR>
<A NAME="0037">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0036" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0038" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>COMPILE mode</H3>

<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;[=compile]&nbsp;{&nbsp;FILENAME&nbsp;|&nbsp;OPTION&nbsp;}</TT> 
<P>COMPILE is the default mode, and can be invoked simply by supplying <TT>xm</TT> with a source module(s) to compile. If <TT>xm</TT> is invoked without a given mode, COMPILE mode is assumed. In order to determine which compiler should be used, <TT>xm</TT> looks at the extensions of the given source files. The default mapping of extensions is given below : 
<P><TABLE CELLSPACING=0>
<TR>
<TD  STYLE="padding:0px 3px;"><B>.mod </B></TD>
<TD ALIGN=CENTER STYLE="padding:0px 3px;">-</TD>
<TD  STYLE="padding:0px 3px;">Modula-2 implementation module </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><B>.def </B></TD>
<TD ALIGN=CENTER STYLE="padding:0px 3px;">-</TD>
<TD  STYLE="padding:0px 3px;">Modula-2 definition module </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><B>.ob2 </B></TD>
<TD ALIGN=CENTER STYLE="padding:0px 3px;">-</TD>
<TD  STYLE="padding:0px 3px;">Oberon-2 module </TD>
</TR>
</TABLE>
<P>For example: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;hello.mod</TT> 
<P>will invoke the Modula-2 compiler, whereas: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;hello.ob2</TT> 
<P>will invoke the Oberon-2 compiler. 
<P>The user is able to reconfigure the extension mapping (See <A HREF="xm003.html#0027" TARGET=body>Filename extensions</A>). It is also possible to override it from the command line using the options <A HREF="xm005.html#0098" TARGET=body>M2</A> and <A HREF="xm005.html#0109" TARGET=body>O2</A>: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;hello.mod&nbsp;+o2&nbsp;&nbsp;(*&nbsp;invokes&nbsp;O2&nbsp;compiler&nbsp;*)</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;hello.ob2&nbsp;+m2&nbsp;&nbsp;(*&nbsp;invokes&nbsp;M2&nbsp;compiler&nbsp;*)</TT> 
<P><B>Note:</B> In the rest of this manual, the COMPILE mode also refers to any case in which the compiler <I>compiles</I> a source file, regardless of the actually specified mode (which can be COMPILE, MAKE, or PROJECT). For instance, an option or equation, which is stated to affect the compiler behaviour in the COMPILE mode, is relevant to MAKE and PROJECT modes as well. 
<P><HR>
<A NAME="0038">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0037" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0039" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>MAKE mode</H3>

<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=make&nbsp;[=batch]&nbsp;[=all]&nbsp;{&nbsp;FILENAME&nbsp;|&nbsp;OPTION&nbsp;}</TT> 
<P>In the MAKE mode the compiler determines module dependencies using <TT>IMPORT</TT> clauses and then recompiles all necessary modules. Starting from the files on the command line, it tries to find an Oberon-2 module or a definition and implementaion module for each imported module. It then does the same for each of the imported modules until all modules are located. Note that a search is made for source files only. If a source file is not found, the imported modules will not be appended to the recompile list. See section <A HREF="#0052" TARGET=body>Make strategy</A> for more details. 
<P>When all modules are gathered, the compiler performs an action according to the operation submode. If the <A HREF="#0043" TARGET=body>BATCH submode</A> was specified, it creates a batch file of all necessary compilations, rather than actually compiling the source code. 
<P>If the <A HREF="#0042" TARGET=body>ALL submode</A> was specified, all gathered files are recompiled, otherwise XDS recompiles only the necessary files. The <I>smart recompilation</I> algorithm is described in <A HREF="#0053" TARGET=body>Smart recompilation</A>. 
<P>Usually, a Modula-2 program module or an Oberon-2 top-level module is specified on the command line. In this case, if the <A HREF="xm005.html#0151" TARGET=body>LINK</A> equation is set in either configuration file or <TT>xm</TT> command line, the linker will be invoked automatically in case of successful compilation. This feature allows you to build simple programs without creating project files. 
<P><HR>
<A NAME="0039">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0038" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0040" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>PROJECT mode</H3>

<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=project&nbsp;[=batch]&nbsp;[=all]&nbsp;{&nbsp;PROJECTFILE&nbsp;|&nbsp;OPTION&nbsp;}</TT> 
<P>The PROJECT mode is essentially the same as the MAKE mode except that the modules to be &lsquo;made&rsquo; are provided in a project file. A project file specifies a set of options and a list of modules. See <A HREF="#0051" TARGET=body>Project files</A> for further details. As in the MAKE mode, <A HREF="#0042" TARGET=body>ALL</A> and <A HREF="#0043" TARGET=body>BATCH</A> submodes can be used. 
<P>If a file extension of a project file is omitted, XDS will use an extension given by the equation <A HREF="xm005.html#0160" TARGET=body>PRJEXT</A> (<B>.prj</B> by default). 
<P>It may be necessary to compile a single module in the environment specified in a project file. It can be accomplished in the COMPILE operation mode using with the <A HREF="xm005.html#0159" TARGET=body>PRJ</A> equation: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;-prj=myproject&nbsp;MyModule.mod</TT> 
<P><B>See also </B>
<UL>
 
<LI>MAKE operation mode: <A HREF="#0038" TARGET=body>MAKE mode</A> </LI>
<LI>Make strategy: <A HREF="#0052" TARGET=body>Make strategy</A> </LI>
<LI>Smart recompilation: <A HREF="#0053" TARGET=body>Smart recompilation</A> </LI>
</UL>

<P><HR>
<A NAME="0040">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0039" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0041" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>GEN mode</H3>

<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=gen&nbsp;{&nbsp;PROJECTFILE&nbsp;|&nbsp;OPTION&nbsp;}</TT> 
<P>The GEN operation mode allows one to generate a file containing information about your project. The most important usage is to generate a makefile, which can then be passed to the make utility accompanying the &quot;underlaying&quot; C compiler, so that all generated C files can be compiled and linked into an executable program. 
<P>This operation mode can also be used to obtain additional information about your project, e.g. a list of all modules, import lists, etc. 
<P>A so-called template file, specified by the <A HREF="xm005.html#0166" TARGET=body>TEMPLATE</A> equation, is used in this mode. A template file is a text file, some lines of which are marked with a certain symbol. All the lines which are not marked are copied to the output file verbatim. The marked lines are processed in a special way. See <A HREF="#0054" TARGET=body>Template files</A> for more information. 
<P>The compiler creates a file with a name specified by the equation <A HREF="xm005.html#0154" TARGET=body>MKFNAME</A>. If the equation is empty, the project file name is used. A file name is then concatenated with the extension specified by the equation <A HREF="xm005.html#0153" TARGET=body>MKFEXT</A>. 
<P><HR>
<A NAME="0041">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0040" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0042" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>BROWSE mode</H3>

<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=browse&nbsp;{&nbsp;MODULENAME&nbsp;|&nbsp;OPTION&nbsp;}</TT> 
<P>The BROWSE operation mode allows one to generate a pseudo definition module for an Oberon-2 module. In this mode, the compiler reads a symbol file and produces a file which contains declarations of all objects exported from the Oberon-2 module, if a format resembling Modula-2 definition modules. 
<P>The configuration option <A HREF="xm005.html#0131" TARGET=body>BSDEF</A> specifies the extension of a generated file. If this option is not set, then the default extension (<B>.odf</B>) will be used. 
<P>Options <A HREF="xm005.html#0065" TARGET=body>BSCLOSURE</A> and <A HREF="xm005.html#0066" TARGET=body>BSREDEFINE</A> can be used to control the form of a generated file. <B>Note:</B> the <A HREF="xm005.html#0132" TARGET=body>BSTYLE</A> equation (described in <A HREF="xm008.html#0464" TARGET=body>Creating a definition</A>) is ignored in this operation mode, and the browse style is always set to DEF. 
<P>The <A HREF="xm005.html#0104" TARGET=body>MAKEDEF</A> option (See <A HREF="xm008.html#0464" TARGET=body>Creating a definition</A>) provides an alternative method of producing pseudo definition modules, preserving so-called <I>exported</I> comments if necessary. 
<P><HR>
<A NAME="0042">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0041" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0043" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>ALL submode</H3>

<P>In both <A HREF="#0039" TARGET=body>PROJECT</A> and <A HREF="#0038" TARGET=body>MAKE</A> modes, the compiler checks the time stamps of the files concerned and recompiles only those files that are necessary (See <A HREF="#0053" TARGET=body>Smart recompilation</A>). If the ALL submode was specified, the time stamps are ignored, and all files are compiled. 
<P><HR>
<A NAME="0043">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0042" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0044" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>BATCH submode</H3>

<P>In the BATCH submode, the compiler creates a batch file of all necessary compilations, rather than actually calling the compilers and compiling the source code. 
<P>A batch file is a sequence of lines beginning with the compiler name, followed by module names to recompile. 
<P>The compiler creates a batch file with a name determined by either: 
<OL>
 
<LI>The compiler option <A HREF="xm005.html#0129" TARGET=body>BATNAME</A> </LI>
<LI>The project file name (if given) </LI>
<LI>The name <B>out</B> (if the name could not be determined by the above). </LI>
</OL>

<P>The name is then concatenated with the batch file extension specified by the equation <A HREF="xm005.html#0128" TARGET=body>BATEXT</A> (<B>.bat</B> by default). 
<P><B>See also </B>
<UL>
 
<LI>option <A HREF="xm005.html#0097" TARGET=body>LONGNAME</A> (<A HREF="xm005.html#0060" TARGET=body>Options</A>) </LI>
<LI>equation <A HREF="xm005.html#0130" TARGET=body>BATWIDTH</A> (<A HREF="xm005.html#0124" TARGET=body>Equations</A>) </LI>
</UL>

<P><HR>
<A NAME="0044">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0043" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0045" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>OPTIONS submode</H3>

<P>The OPTIONS submode allows you to inspect the values of options which are set in the configuration file, project file and on the command line. It can be used together with <A HREF="#0037" TARGET=body>COMPILE</A>, <A HREF="#0038" TARGET=body>MAKE</A>, and <A HREF="#0039" TARGET=body>PROJECT</A> modes. 
<P>The following command line prints (to the standard output) the list of all defined options, including all pre-declared options, all options declared in the configuration file, in the project file <TT>my.prj</TT> and on the command line (<TT>xyz</TT> option): 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=options&nbsp;-prj=my.prj&nbsp;-xyz:+</TT> 
<P>In the PROJECT mode options are listed for each project file given on the command line. 
<P>See also the <A HREF="#0045" TARGET=body>EQUATIONS submode</A>. 
<P><HR>
<A NAME="0045">
<A HREF="#0036" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0044" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0046" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>EQUATIONS submode</H3>

<P>The EQUATIONS submode allows you to inspect the values of equations which are set in the configuration file, project file and on the command line. It can be used together with <A HREF="#0037" TARGET=body>COMPILE</A>, <A HREF="#0038" TARGET=body>MAKE</A>, and <A HREF="#0039" TARGET=body>PROJECT</A> modes. 
<P>See also the <A HREF="#0044" TARGET=body>OPTIONS submode</A>. 
<P><HR>
<A NAME="0046">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0045" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0047" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Files generated during compilation</H2>

<P>When applied to a file which contains a module <B>name</B>, the compilers produce the following files. 
<P><UL>
<LI><A HREF="#0047" TARGET=body>Modula-2 compiler</A>
<LI><A HREF="#0048" TARGET=body>Oberon-2 compiler</A>
</UL>
<P><HR>
<A NAME="0047">
<A HREF="#0046" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0046" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0048" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>Modula-2 compiler</H3>

<P>When applied to a definition module, the Modula-2 compiler produces a <I>symbol file</I>(<B>name.sym</B>) and a C header file (<B>name.h</B>). Generation of a header file can be prevented by use of the <A HREF="xm005.html#0107" TARGET=body>NOHEADER</A> option. The symbol file contains information required during compilation of a module which imports the module <B>name</B>. 
<P>When applied to an implementation module or a top level module, the Modula-2 compiler produces a C code file (<B>name.c</B>).
<P><HR>
<A NAME="0048">
<A HREF="#0046" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0047" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0049" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>Oberon-2 compiler</H3>

<P>For all compiled modules, the Oberon-2 compiler produces a <I>symbol file</I> (<B>name.sym</B>), a C header file (<B>name.h</B>) and a code file (<B>name.c</B>). The symbol file(<B>name.sym</B>) contains information required during compilation of a module which imports the module <B>name</B>. If the compiler needs to overwrite an existing symbol file, it will only do so if the <A HREF="xm005.html#0067" TARGET=body>CHANGESYM</A> option is set ON. 
<P><A NAME="0049">
<A HREF="#0048" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0048" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0050" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H5>Examples</H5>
<TABLE CELLSPACING=0>
<TR>
<TD  STYLE="padding:0px 3px;border-style: none none solid none;border-width: 0px 0px 1px 0px"><B>Command line </B></TD>
<TD  STYLE="padding:0px 3px;border-style: none none solid none;border-width: 0px 0px 1px 0px"><B>Generated files </B></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>xm Example.def </TT></TD>
<TD  STYLE="padding:0px 3px;"><TT>Example.sym</TT></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;">&nbsp;</TD>
<TD  STYLE="padding:0px 3px;"><TT>Example.h</TT></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>xm Example.mod </TT></TD>
<TD  STYLE="padding:0px 3px;"><TT>Example.c</TT></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>xm Win.ob2 +CHANGESYM </TT></TD>
<TD  STYLE="padding:0px 3px;"><TT>Win.sym</TT></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;">&nbsp;</TD>
<TD  STYLE="padding:0px 3px;"><TT>Win.h</TT></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;">&nbsp;</TD>
<TD  STYLE="padding:0px 3px;"><TT>Win.c</TT></TD>
</TR>
</TABLE>
<P><HR>
<A NAME="0050">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0049" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0051" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Control file preprocessing</H2>

<P>An XDS compiler may read the following control files during execution: 
<UL>
 
<LI>a <A HREF="xm003.html#0020" TARGET=body>redirection file</A> </LI>
<LI>a <A HREF="xm003.html#0026" TARGET=body>configuration file</A> </LI>
<LI>a <A HREF="#0051" TARGET=body>project file</A> </LI>
<LI>a <A HREF="#0054" TARGET=body>template file</A> </LI>
</UL>
All these files are preprocessed during read according to the following rules: 
<P>A control file is a plain text file containing a sequence of lines. The backslash character (<TT>&quot;\&quot;</TT>) at the end of a line denotes its continuation. 
<P>The following constructs are handled during control file preprocessing: 
<UL>
 
<LI>macros of the kind <TT>$(</TT><I>name</I><TT>)</TT>. A macro expands to the value of the equation <I>name</I> or, if it does not exist, to the value of the environment variable <I>name</I>. </LI>
<LI>the <I>base directory</I> macro (<TT>$!</TT>) This macro expands to the directory in which the file containing it resides. </LI>
<LI>a set of directives, denoted by the exclamation mark (<TT>&quot;!&quot;</TT>) as a first non-whitespace character on a line. </LI>
</UL>

<P>A directive has the following syntax (all keywords are case independent): 
<P><PRE>Directive&nbsp;=&nbsp;&quot;!&quot;&nbsp;&quot;NEW&quot;&nbsp;SetOption&nbsp;|&nbsp;SetEquation
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;!&quot;&nbsp;&quot;SET&quot;&nbsp;SetOption&nbsp;|&nbsp;SetEquation
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;!&quot;&nbsp;&quot;MESSAGE&quot;&nbsp;Expression
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;!&quot;&nbsp;&quot;IF&quot;&nbsp;Expression&nbsp;&quot;THEN&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;!&quot;&nbsp;&quot;ELSIF&quot;&nbsp;Expression&nbsp;&quot;THEN&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;!&quot;&nbsp;&quot;ELSE&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;!&quot;&nbsp;&quot;END&quot;.
SetOption&nbsp;&nbsp;&nbsp;=&nbsp;name&nbsp;(&nbsp;&quot;+&quot;&nbsp;|&nbsp;&quot;-&quot;&nbsp;).
SetEquation&nbsp;=&nbsp;name&nbsp;&quot;=&quot;&nbsp;string.
</PRE>

<P>The <TT>NEW</TT> directive declares a new option or equation. The <TT>SET</TT> directive changes the value of an existent option or equation. The <TT>MESSAGE</TT> directive prints <TT>Expression</TT> value to the standard output. The <TT>IF</TT> directive allows to process or skip portions of files according to the value of <TT>Expression</TT>. <TT>IF</TT> directives may be nested. 
<P><PRE>Expression&nbsp;&nbsp;=&nbsp;Simple&nbsp;[&nbsp;Relation&nbsp;Simple&nbsp;].
Simple&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Term&nbsp;{&nbsp;&quot;+&quot;&nbsp;|&nbsp;OR&nbsp;Term&nbsp;}.
Relation&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&quot;=&quot;&nbsp;|&nbsp;&quot;#&quot;&nbsp;|&nbsp;&quot;&lt;&quot;&nbsp;|&nbsp;&quot;&gt;&quot;.
Term&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Factor&nbsp;{&nbsp;AND&nbsp;Factor&nbsp;}.
Factor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&quot;(&quot;&nbsp;Expression&nbsp;&quot;)&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;String
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;NOT&nbsp;Factor
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;DEFINED&nbsp;name
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;name.
String&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&quot;'&quot;&nbsp;{&nbsp;character&nbsp;}&nbsp;&quot;'&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;'&quot;'&nbsp;{&nbsp;character&nbsp;}&nbsp;'&quot;'.
</PRE>

<P>An operand in an expression is either string, equation name, or option name. In the case of equation, the value of equation is used. In the case of option, a string <TT>&quot;TRUE&quot;</TT> or <TT>&quot;FALSE&quot;</TT> is used. The <TT>&quot;+&quot;</TT> operator denotes string concatenation. Relation operators perform case insensitive string comparison. The <TT>NOT</TT> operator may be applied to a string with value <TT>&quot;TRUE&quot;</TT> or <TT>&quot;FALSE&quot;</TT>. The <TT>DEFINED</TT> operator yields <TT>&quot;TRUE&quot;</TT> if an option or equation <TT>name</TT> is declared and <TT>&quot;FALSE&quot;</TT> otherwise. 
<P>See also section <A HREF="xm005.html#0168" TARGET=body>The system module COMPILER</A>. 
<P><HR>
<A NAME="0051">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0050" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0052" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Project files</H2>

<P>A project file has the following structure: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;{SetupDirective}</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;{!module&nbsp;{FileName}}</TT> 
<P>Setup directives define options and equations that all modules which constitute the project should be compiled with. See also <A HREF="xm003.html#0024" TARGET=body>Options</A> and <A HREF="#0050" TARGET=body>Control file preprocessing</A>. 
<P>Every line in a project file can contain only one setup directive. The character &quot;<TT>%</TT>&quot; indicated a comment; it causes the rest of a line to be discarded. <B>Note:</B> the comment character can not be used in a string containing equation setting. 
<P>Each <TT>FileName</TT> is a name of a file which should be compiled, linked, or otherwise processed when a project is being built, e.g. a source file, an additional library, a resource file (on Windows), etc. The compiler processes only Modula-2 and Oberon-2 source files. The type of a file is determined by its extension (by default Modula-2/Oberon-2 source files extension is assumed). Files of other types are taken into account only when a template file is processed (see <A HREF="#0054" TARGET=body>Template files</A>). 
<P>The compiler recursively scans import lists of all specified Modula-2/Oberon-2 source modules and builds the full list of modules used in the project. Thus, usually, a project file for an executable program would contain a single <TT>!module</TT> directive for the file which contains the main program module and, optionally, several <TT>!module</TT> directives for non-source files. 
<P>At least one <TT>!module</TT> directive should be specified in a project file. 
<P>A project file can contain several <A HREF="xm005.html#0152" TARGET=body>LOOKUP</A> equations, which allow you to define additional search paths. 
<P>XDS compilers give you complete freedom over where to set options, equations and redirection directives. However, it is recommended to specify only those settings in the configuration and redirection files which are applied to all your projects, and use project files for all project-specific options and redirection directives. 
<P><P ALIGN=CENTER><B><A NAME=figure2>Figure 2. </A></B>A Sample Project File

<P><PRE>&nbsp;&nbsp;&nbsp;&nbsp;-lookup&nbsp;=&nbsp;*.mod&nbsp;=&nbsp;mod
&nbsp;&nbsp;&nbsp;&nbsp;-lookup&nbsp;=&nbsp;*.sym&nbsp;=&nbsp;sym;&nbsp;$(XDSDIR)/sym/C
&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;check&nbsp;project&nbsp;mode
&nbsp;&nbsp;&nbsp;&nbsp;!if&nbsp;not&nbsp;defined&nbsp;mode&nbsp;then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;by&nbsp;default&nbsp;use&nbsp;debug&nbsp;mode
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!new&nbsp;mode&nbsp;=&nbsp;debug
&nbsp;&nbsp;&nbsp;&nbsp;!end
&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;report&nbsp;the&nbsp;project&nbsp;mode
&nbsp;&nbsp;&nbsp;&nbsp;!message&nbsp;&quot;Making&nbsp;project&nbsp;in&nbsp;the&nbsp;&quot;&nbsp;+&nbsp;mode&nbsp;+&nbsp;&quot;&nbsp;mode&quot;
&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;set&nbsp;options&nbsp;according&nbsp;to&nbsp;the&nbsp;mode
&nbsp;&nbsp;&nbsp;&nbsp;!if&nbsp;mode&nbsp;=&nbsp;debug&nbsp;then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;gendebug+
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;checkrange+
&nbsp;&nbsp;&nbsp;&nbsp;!else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;gendebug-
&nbsp;&nbsp;&nbsp;&nbsp;!fi
&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;specify&nbsp;template&nbsp;file
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;template&nbsp;=&nbsp;$!/templates/watcom.tem
&nbsp;&nbsp;&nbsp;&nbsp;!module&nbsp;hello
&nbsp;&nbsp;&nbsp;&nbsp;!module&nbsp;hello.res
</PRE>

<P>
<P>Given the sample project file shown on Figure <A HREF=#table2>2. A Sample Project File</A>, the compiler will search for files with <TT>.mod</TT> and <TT>.sym</TT> extensions using search paths specified in the project file <I>before</I> paths specified in a redirection file. 
<P>A project file is specified explicitly in the <A HREF="#0039" TARGET=body>PROJECT</A> and <A HREF="#0040" TARGET=body>GEN</A> operation modes. In these modes, all options and equations are set and then the compiler proceeds through the module list to gather all modules constituting a project (See <A HREF="#0052" TARGET=body>Make strategy</A>). 
<P>In the <A HREF="#0038" TARGET=body>MAKE</A> and <A HREF="#0037" TARGET=body>COMPILE</A> operation modes, a project file can be specified using the <A HREF="xm005.html#0159" TARGET=body>PRJ</A> equation. In this case, the module list is ignored, but all options and equations from the project file are set. 
<P>The following command line forces the compiler to compile the module <TT>hello.mod</TT> using options and equations specified in the project file <TT>hello.prj</TT>: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;hello.mod&nbsp;-prj=hello.prj</TT> 
<P><HR>
<A NAME="0052">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0051" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0053" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Make strategy</H2>

<P>This section concerns <A HREF="#0038" TARGET=body>MAKE</A>, <A HREF="#0039" TARGET=body>PROJECT</A>, and <A HREF="#0040" TARGET=body>GEN</A>, operation modes. In these modes, an XDS compiler builds a set of all modules that constitute the project, starting from the modules specified in a project file (PROJECT and GEN) or on the command line (MAKE). 
<P>The MAKE mode is used in the following examples, but the comments also apply to the PROJECT and GEN modes. 
<P>First, the compiler tries to find all given modules according to the following strategy: 
<UL>
 
<LI>If both filename extension and path are present, the compiler checks if the given file exists. 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=make&nbsp;mod</TT>/<TT>hello.mod</TT> </LI>
<LI>If only an extension is specified, the compiler seeks the given file using search paths. 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=make&nbsp;hello.mod</TT> </LI>
<LI>If no extension is specified, the compiler searches for files with the given name and the Oberon-2 module extension, Modula-2 implementation module extension, and Modula-2 definition module extension. 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;</TT><TT>xm</TT><TT>&nbsp;=make&nbsp;hello</TT> 
<P>An error is raised if more than one file was found, e.g. if both <TT>hello.ob2</TT> and <TT>hello.mod</TT> files exist. </LI>
</UL>

<P>Starting from the given files, the compiler tries to find an Oberon-2 source module or Modula-2 definition and implementation modules for each imported module. It then tries to do the same for each of the imported modules until all the possible modules are located. For each module, the compiler checks correspondence between the file name extension and the kind of the module. 
<P><HR>
<A NAME="0053">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0052" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0054" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Smart recompilation</H2>

<P>In the <A HREF="#0038" TARGET=body>MAKE</A> and <A HREF="#0039" TARGET=body>PROJECT</A> modes, if the <A HREF="#0042" TARGET=body>ALL</A> submode was not specified, an XDS compiler performs <I>smart recompilation</I> of modules which are inconsistent with the available source code files. The complier uses file modification time to determine which file has been changed. For each module the decision (to recompile or not) is made only after the decision is made for all modules on which it depends. A source file is (re)compiled if one or more of the following conditions is true: 
<DL>
 
<DT>Modula-2 definition module</DT>
<DD> 
<UL>
 
<LI>the symbol file is missing </LI>
<LI>the symbol file is present but its modification date is earlier than that of the source file or one of the imported symbol files </LI>
<LI>the header file is missing (<A HREF="xm005.html#0107" TARGET=body>NOHEADER</A> option is OFF) or its modification date is earlier than that of the source file </LI>
</UL>
</DD>
<DT>Modula-2 implementation module</DT>
<DD> 
<UL>
 
<LI>the code file is missing </LI>
<LI>the code file is present but the file modification date is earlier than that of the source file or one of the imported symbol files (including its own symbol file) </LI>
</UL>
</DD>
<DT>Modula-2 program module</DT>
<DD> 
<UL>
 
<LI>the code file is missing </LI>
<LI>the code file is present but the file modification date is earlier than that of the source file or one of the imported symbol files </LI>
</UL>
</DD>
<DT>Oberon-2 module</DT>
<DD> 
<UL>
 
<LI>the symbol file is missing </LI>
<LI>the symbol file is present but the modification date is earlier than that of one of the imported symbol files </LI>
<LI>the header file is missing (<A HREF="xm005.html#0107" TARGET=body>NOHEADER</A> option is OFF) </LI>
<LI>the code file is missing </LI>
<LI>the code file is present but the file modification date is earlier than that of the source file or one of the imported symbol files </LI>
</UL>
</DD>
</DL>

<P>When the <A HREF="xm005.html#0119" TARGET=body>VERBOSE</A> option is set ON, the compiler reports a reason for recompilation of each module. <B>Note:</B> if an error occured during compilation of a Modula-2 definition module or an Oberon-2 module, all its client modules are not compiled at all. 
<P><HR>
<A NAME="0054">
<A HREF="#0033" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0053" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0055" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H2>Template files</H2>

<P>A <I>template file</I> is used to build a &quot;makefile&quot; in the <A HREF="#0039" TARGET=body>PROJECT</A> and <A HREF="#0040" TARGET=body>GEN</A> operation modes, if the option <A HREF="xm005.html#0105" TARGET=body>MAKEFILE</A> is ON<FONT SIZE=2>&nbsp;/ &quot;MAKEFILE&quot; is a historical name; a linker or library manager response file may be built as well./ </FONT>. 
<P>The compiler copies lines from a template file into the output file verbatim, except lines marked as requiring further attention. A single character (attention mark) is specified by the equation <A HREF="xm005.html#0127" TARGET=body>ATTENTION</A> (default is &rsquo;!&rsquo;) 
<P>A template file is also subject to <A HREF="#0050" TARGET=body>preprocessing</A>. 
<P>A marked line (or template) has the following format<FONT SIZE=2>&nbsp;/The same syntax is used in the <A HREF="xm005.html#0151" TARGET=body>LINK</A> equation./ </FONT>: 
<P><PRE>&nbsp;&nbsp;&nbsp;&nbsp;Template&nbsp;&nbsp;=&nbsp;{&nbsp;Sentence&nbsp;}.
&nbsp;&nbsp;&nbsp;&nbsp;Sentence&nbsp;&nbsp;=&nbsp;Item&nbsp;{&nbsp;&quot;,&quot;&nbsp;Item&nbsp;}&nbsp;&quot;;&quot;&nbsp;|&nbsp;Iterator.
&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Atom&nbsp;|&nbsp;[&nbsp;Atom&nbsp;|&nbsp;&quot;^&quot;&nbsp;]&nbsp;&quot;#&quot;&nbsp;[&nbsp;Extension&nbsp;].
&nbsp;&nbsp;&nbsp;&nbsp;Atom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;String&nbsp;|&nbsp;name.
&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&quot;'&nbsp;{&nbsp;character&nbsp;}&nbsp;'&quot;'
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;'&quot;&nbsp;{&nbsp;character&nbsp;}&nbsp;&quot;'&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;Extension&nbsp;=&nbsp;[&nbsp;&quot;&gt;&quot;&nbsp;]&nbsp;Atom.
&nbsp;&nbsp;&nbsp;&nbsp;Iterator&nbsp;&nbsp;=&nbsp;&quot;{&quot;&nbsp;Set&nbsp;&quot;:&quot;&nbsp;{&nbsp;Sentence&nbsp;}&nbsp;&quot;}&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;{&nbsp;Keyword&nbsp;|&nbsp;String&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;Keyword&nbsp;&nbsp;&nbsp;=&nbsp;DEF&nbsp;|&nbsp;IMP&nbsp;|&nbsp;OBERON&nbsp;|&nbsp;MAIN
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;C&nbsp;|&nbsp;HEADER&nbsp;|&nbsp;ASM&nbsp;|&nbsp;OBJ.
</PRE>

<P><TT>name</TT> should be a name of an equation. Not more than three items may be used in a sentence. A first item in a sentence is a format string, while others are arguments. 
<P>The XDS distribution contains a template file <TT>xm.tem</TT> which can be used to produce a makefile for one of the supported C compilers. 
<P><UL>
<LI><A HREF="#0055" TARGET=body>Using equation values</A>
<LI><A HREF="#0056" TARGET=body>File name construction</A>
<LI><A HREF="#0057" TARGET=body>Iterators</A>
<LI><A HREF="#0058" TARGET=body>Examples</A>
</UL>
<P><HR>
<A NAME="0055">
<A HREF="#0054" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0054" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0056" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>Using equation values</H3>

<P>In the simplest form, a template line may be used to output a value of an equation. For example, if the template file contains the line 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;&quot;The&nbsp;current&nbsp;project&nbsp;is&nbsp;%s.\n&quot;,prj;</TT> 
<P>and the project <TT>prj/test.prj</TT> is processed, the output will contain the line 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;current&nbsp;project&nbsp;is&nbsp;prj</TT><TT>/</TT><TT>test.prj.</TT> 
<P><B>Note:</B> the line 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;prj;</TT> 
<P>is valid, but may produce unexpected results under systems in which the backslash character (&quot;<TT>\</TT>&quot;) is used as a directory names separator (e.g. OS/2 or Windows): 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;prj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est.prj</TT> 
<P>because <TT>&quot;\t&quot;</TT> in a format string is replaced with the tab character. Use the following form instead: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;&quot;%s&quot;,prj;</TT> 
<P><HR>
<A NAME="0056">
<A HREF="#0054" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0055" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0057" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>File name construction</H3>

<P>The <TT>&quot;#&quot;</TT> operator constructs a file name from a name and an extension, each specified as an equation name or literal string. A file is then searched for according to XDS search paths and the resulting name is substituted. For example, if the file <TT>useful.lib</TT> resides in the directory &rsquo;../mylibs&rsquo; and the redirection file contains the following line: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;*.lib&nbsp;=&nbsp;/xds/lib;../mylibs</TT> 
<P>the line 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;&quot;useful&quot;#&quot;lib&quot;</TT> 
<P>will produce 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;../mylibs/useful.lib</TT> 
<P>If the modifier <TT>&quot;&gt;&quot;</TT> is specified, the compiler assumes that the file being constructed is an output file and creates its name according to the strategy for output files (See <A HREF="xm003.html#0020" TARGET=body>Redirection file</A> and the <A HREF="xm005.html#0114" TARGET=body>OVERWRITE</A> option). 
<P>The <TT>&quot;#&quot;</TT> operator is also used to represent the current value of an <A HREF="#0057" TARGET=body>iterator</A>. The form in which a name or extension is omitted can be used in an iterator only. 
<P>The form <TT>&quot;^#&quot;</TT> may be used in a second level iterator to represent the current value of the first level iterator. 
<P><HR>
<A NAME="0057">
<A HREF="#0054" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0056" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="#0058" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>Iterators</H3>

<P><I>Iterators</I> are used to generate some text for all modules from a given set. Sentences inside the first level of braces are repeated for all modules of the project, while sentences inside the second level are repeated for all modules imported into the module currently iterated at the first level. A set is a sequence of keywords and strings. Each string denotes a specific module, while a keyword denotes all modules of specific kind. 
<P>The meaning of keywords is as follows: 
<TABLE CELLSPACING=0>
<TR>
<TD  STYLE="padding:0px 3px;border-style: none none solid none;border-width: 0px 0px 1px 0px"><B>Keyword </B></TD>
<TD  STYLE="padding:0px 3px;border-style: none none solid none;border-width: 0px 0px 1px 0px"><B>Meaning </B></TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>DEF </TT></TD>
<TD  STYLE="padding:0px 3px;">Modula-2 definition module </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>IMP </TT></TD>
<TD  STYLE="padding:0px 3px;">Modula-2 implementation module </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>MAIN </TT></TD>
<TD  STYLE="padding:0px 3px;">Modula-2 program module or Oberon-2 module marked as <A HREF="xm005.html#0103" TARGET=body>MAIN</A> </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>OBERON </TT></TD>
<TD  STYLE="padding:0px 3px;">Oberon module </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>C </TT></TD>
<TD  STYLE="padding:0px 3px;">C source text </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>HEADER </TT></TD>
<TD  STYLE="padding:0px 3px;">C header file </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>ASM </TT></TD>
<TD  STYLE="padding:0px 3px;">assembler source text </TD>
</TR>
<TR>
<TD  STYLE="padding:0px 3px;"><TT>OBJ </TT></TD>
<TD  STYLE="padding:0px 3px;">object file </TD>
</TR>
</TABLE>
<P>A keyword not listed above is treated as filename extension. Sentences are repeated for all files with that extension which are explicitly specified in the project file using <TT>!module</TT> directives (see <A HREF="#0051" TARGET=body>Project files</A>). This allows, for instance, additional libraries to be specified in a project file: 
<P><PRE>sample.prj:

&nbsp;&nbsp;&nbsp;&nbsp;-template&nbsp;=&nbsp;mytem.tem
&nbsp;&nbsp;&nbsp;&nbsp;!module&nbsp;Sample.mod
&nbsp;&nbsp;&nbsp;&nbsp;!module&nbsp;mylib.lib

mytem.tem:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;&quot;%s&quot;,&quot;libxds&quot;#&quot;lib&quot;
&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;{&nbsp;lib:&nbsp;&quot;+%s&quot;,#;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;&quot;\n&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.

generated&nbsp;file:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
&nbsp;&nbsp;&nbsp;&nbsp;d:\xds\lib\x86\libxds.lib+mylib.lib
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
</PRE>

<P><HR>
<A NAME="0058">
<A HREF="#0054" TARGET=body><IMG ALT="Super" SRC="super.gif" BORDER=0></A>
<A HREF="#0057" TARGET=body><IMG ALT="Prev" SRC="prev.gif" BORDER=0></A>
<A HREF="xm005.html#0059" TARGET=body><IMG ALT="Next" SRC="next.gif" BORDER=0></A></A>
<BR>
<H3>Examples</H3>

<P>Consider a sample project which consists of a program module <TT>A</TT>, which imports modules <TT>B</TT> and <TT>C</TT>, and <TT>B</TT>, in turn, imports <TT>D</TT> (all modules are written in Modula-2): 
<P><PRE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;&nbsp;C
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D
</PRE>

<P>The following examples illustrate template files usage: 
<P>This template line lists all project modules for which source files are available: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;{&nbsp;imp&nbsp;oberon&nbsp;main:&nbsp;&quot;%s&nbsp;&quot;,#;&nbsp;}</TT> 
<P>For the sample project, it would generate the following line: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;A.mod&nbsp;B.mod&nbsp;C.mod&nbsp;D.mod</TT> 
<P>To output both definition and implementation modules, the following lines may be used: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;{&nbsp;def&nbsp;:&nbsp;&quot;%s&nbsp;&quot;,#;&nbsp;}</TT><BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;{&nbsp;imp&nbsp;oberon&nbsp;main:&nbsp;&quot;%s&nbsp;&quot;,#;&nbsp;}</TT> 
<P>The output would be: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;B.def&nbsp;C.def&nbsp;D.def&nbsp;A.mod&nbsp;B.mod&nbsp;C.mod&nbsp;D.mod</TT> 
<P>The last template line may be used to list all modules along with their import: 
<P><TT>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;{&nbsp;imp&nbsp;main:&nbsp;&quot;%s\n&quot;,#;&nbsp;{&nbsp;def:&nbsp;&quot;&nbsp;&nbsp;%s\n&quot;,#;&nbsp;}&nbsp;}</TT> 
<P>The output: 
<P><PRE>&nbsp;&nbsp;&nbsp;&nbsp;A.mod
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.def
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.def
&nbsp;&nbsp;&nbsp;&nbsp;B.mod
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D.def
&nbsp;&nbsp;&nbsp;&nbsp;C.mod
&nbsp;&nbsp;&nbsp;&nbsp;D.mod
</PRE>

<P></BODY>
</HTML>
